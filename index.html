-- STORETRAK Database Schema
-- Run this in your Supabase SQL Editor

-- Rooms table
create table if not exists rooms (
  id uuid primary key default gen_random_uuid(),
  name text not null,
  code text not null unique,
  created_at timestamptz default now()
);

-- Totes table
create table if not exists totes (
  id text primary key, -- e.g. GAR-01
  room_id uuid references rooms(id) on delete cascade,
  name text not null,
  shelf text,
  created_at timestamptz default now()
);

-- Items table
create table if not exists items (
  id uuid primary key default gen_random_uuid(),
  tote_id text references totes(id) on delete cascade,
  name text not null,
  category text not null default 'other',
  notes text,
  created_at timestamptz default now()
);

-- Enable Row Level Security (open policy for personal use)
alter table rooms enable row level security;
alter table totes enable row level security;
alter table items enable row level security;

-- Allow all operations with the anon key (personal app, no auth needed)
create policy "allow all rooms" on rooms for all using (true) with check (true);
create policy "allow all totes" on totes for all using (true) with check (true);
create policy "allow all items" on items for all using (true) with check (true);
